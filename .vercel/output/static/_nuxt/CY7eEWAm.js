import{_ as g}from"./DuvxkUR_.js";import{_ as x}from"./DykwY3kg.js";import{g as m,j as y,A as T,D as h,C as k,c as I,b as n,w as i,H as O,I as R,o as C,d as N,h as p}from"./D2dFwJ2f.js";import{u as E}from"./CjDdrw6I.js";import{v as c}from"./CEwmuECH.js";const A={__name:"login",setup(L){const u=O(),f=m(()=>u.public.mode),t=y({email:null,pwd:null});T(()=>{f.value==="development"&&(t.value={email:u.public.authId,pwd:u.public.authPwd})});const _=m(()=>({notValue:Object.values(t.value).some(o=>o==null||o==="")})),r=E(),v=h(),w=k(),b=async o=>{o.preventDefault();try{const e=await $fetch("/api/auth/login",{method:"POST",body:{...t.value}});if(e){const{uid:l,refreshToken:d,accessToken:s}=e;v.setToken(s),r.add({id:"login-complete",title:"로그인에 성공하였습니다.",icon:"memory:login"}),w.push("/admin")}}catch(e){r.add({id:"login-fail",title:`ERROR ${e.statusCode}`,description:e.data.message||"로그인중에 문제가 발생하였습니다.",icon:"memory:alert-octagon",color:"red"})}};return(o,e)=>{const l=g,d=x,s=R;return C(),I("div",null,[n(s,{name:"auth-body"},{title:i(()=>[N(" LOGIN ")]),content:i(()=>[n(d,{cancelable:!1,validate:_.value,onSubmit:e[2]||(e[2]=a=>b(a)),onOnFocus:e[3]||(e[3]=a=>o.onFocused=!0),submitText:"Login"},{default:i(()=>[n(l,{form:t.value,title:"Email",bind:"email",inputType:"email",onInput:e[0]||(e[0]=a=>t.value.email=a),autocomplete:"user-email",required:!0,id:"user-email",validate:p(c)("email",t.value.email)},null,8,["form","validate"]),n(l,{form:t.value,title:"Password",bind:"pwd",inputType:"password",onInput:e[1]||(e[1]=a=>t.value.pwd=a),autocomplete:"current-password",required:!0,id:"user-pwd",class:"mt-5",validate:p(c)("password",t.value.pwd)},null,8,["form","validate"])]),_:1},8,["validate"])]),_:1})])}}};export{A as default};
