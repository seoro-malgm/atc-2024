import{_ as H}from"./ClxLudO0.js";import{_ as J}from"./BU7Uc7KU.js";import{_ as K}from"./DC3EEefv.js";import{_ as U,f as W,j as $,g as A,k as X,l as Y,c as a,h as d,a as n,F as v,m as C,b as Z,n as r,i as L,w as ee,o as t,t as I,q as O,d as F,p as te,e as ae}from"./DKUbIslQ.js";import{u as oe}from"./BhHmZ4V8.js";import{u as se}from"./BC8hgVDH.js";import"./qzjNJ8tb.js";import"./xY5XUOcG.js";import"./qsMMcMsd.js";const D=o=>(te("data-v-2df78cbf"),o=o(),ae(),o),le={key:0},ne={class:"table mb-8"},ce={class:"text-left"},re=D(()=>n("th",null,"관리",-1)),de={key:0},ue=["colspan"],ie=["width"],ye=["href"],he=["href"],_e={class:"py-2 border-b",width:"10%"},ke={class:"flex flex-col"},fe=["onClick"],pe=["onClick"],ve=["onClick"],be={key:1},ge=["colspan"],xe=D(()=>n("div",{class:"text-center"},[n("span",{class:"text-sm"},"표시할 데이터가 없습니다.")],-1)),me=[xe],we={class:"mt-3"},$e={class:"footer-util"},Ce={key:1,class:"text-gray-400"},Ie={key:1,class:"text-center pt-4 pb-8 border-b border-b-gray-300"},De=D(()=>n("span",{class:"text-sm text-grayscale-500"}," 데이터가 없습니다.",-1)),qe=[De],Ee={class:"floating-btn"},Ne={__name:"index",props:{col:{type:Object,default:null},addQuery:{type:Object,default:null}},async setup(o){let b,q;const E=W(),u=o,N=oe(),x=$(null),i=A(()=>{var s;return{...(s=u.col)==null?void 0:s.defaultQuery,...u.addQuery,...E.query}}),y=$(!1),j=async s=>{var _;y.value=!1;const c=await $fetch(`/api/collection/${u.col.key}`,{query:s});return(_=i==null?void 0:i.value)!=null&&_.limit&&(c==null?void 0:c.length)<i.value.limit&&(y.value=!0),c},{data:g,pending:m,error:je,refresh:M}=([b,q]=X(async()=>se(`${u.col.key}-items-admin`,async()=>{var s;return await j({...(s=u.col)==null?void 0:s.defaultQuery,...u.addQuery,...E.query})})),b=await b,q(),b),k=$([]),h=A(()=>[...g.value,...k.value]),z=async()=>{const s=h.value[h.value.length-1].id;x.value===s&&(y.value=!0),x.value=s;const c=await j({...i.value,startAfter:s});c&&(k.value=[...k.value,...c])};Y(()=>i.value,async(s,c)=>{k.value=[],x.value=null,y.value=!1,await M()});const P=async(s,c,_)=>{if(await window.confirm("삭제사히겠습니까?"))try{if(await $fetch(`/api/${s}/document`,{method:"DELETE",query:{id:c}})){N.add({id:`work-delete-${new Date().getTime()}`,title:"정상적으로 삭제했습니다.",icon:"memory:checkbox-marked"});const p=[...g.value,...k.value];p.splice(_,1),g.value=p}}catch(f){N.add({id:`${u.col.key}-delete-fail`,title:`ERROR ${f.statusCode}`,description:f.data.message||"문제가 발생하여 실패햇습니다.",icon:"memory:alert-octagon",color:"red"})}};return(s,c)=>{var p,T,B,R,S,V;const _=H,Q=J,f=K;return t(),a("div",null,[(p=d(h))!=null&&p.length?(t(),a("section",le,[n("table",ne,[n("thead",null,[n("tr",null,[(t(!0),a(v,null,C(o.col.list.key,(l,w)=>(t(),a("th",ce,I(l.text),1))),256)),re])]),n("tbody",null,[d(m)?(t(),a("tr",de,[n("td",{colspan:((T=o.col.list.key)==null?void 0:T.length)+1},[Z(_)],8,ue)])):r("",!0),(t(!0),a(v,null,C(d(h),(l,w)=>(t(),a("tr",{key:w},[(t(!0),a(v,null,C(o.col.list.key,(e,G)=>(t(),a("td",{key:G,width:e!=null&&e.width?`${e.width}%`:"auto"},[l[e.value]||l[e.value]!==""?(t(),a(v,{key:0},[e.type==="string"?(t(),a("p",{key:0,class:O(["truncate max-w-full px-3",e==null?void 0:e.addtionalClass])},I(l[e.value]),3)):e.type==="url"?(t(),a("a",{key:1,class:O(["link-item text-blue-400 underline mx-2 px-2",e==null?void 0:e.addtionalClass]),href:`https://seoro-malgm.studio/${e.url}/${l[e.value]}`,target:"_blank"},I(l[e.value]),11,ye)):e.type==="image"?(t(),L(Q,{key:2,preset:e.preset||"adminThumbnail",src:l[e.value]},null,8,["preset","src"])):e.type==="file"?(t(),a("a",{key:3,href:l[e.value],target:"_blank",class:"link-item text-blue-400 underline mx-2 px-2"}," 미리보기 ",8,he)):(t(),a(v,{key:4},[F(" - ")],64))],64)):r("",!0)],8,ie))),128)),n("td",_e,[n("div",ke,[o.col.removeable?(t(),a("button",{key:0,onClick:e=>P(o.col.key,l==null?void 0:l.id,w),class:"bg-classic-rose-600 text-grayscale-200 rounded-md mb-1 py-1"}," 삭제 ",8,fe)):r("",!0),o.col.editable?(t(),a("button",{key:1,class:"bg-baja-white-500 text-grayscale-200 rounded-md py-1",onClick:e=>s.$router.push({path:`/admin/${o.col.key}/write`,query:{id:l==null?void 0:l.id}})}," 수정 ",8,pe)):r("",!0),o.col.preview?(t(),a("button",{key:2,class:"bg-baja-white-500 text-grayscale-200 rounded-md py-1",onClick:e=>s.$router.push({path:`/admin/${o.col.key}/${l.id}`})}," 상세보기 ",8,ve)):r("",!0)])])]))),128)),(B=d(h))!=null&&B.length?r("",!0):(t(),a("tr",be,[n("td",{colspan:((R=o.col.list.key)==null?void 0:R.length)+1},me,8,ge)]))])]),n("section",we,[n("nav",$e,[!d(m)&&!d(y)&&o.col.viewMoreable?(t(),a("button",{key:0,onClick:c[0]||(c[0]=l=>z()),class:"inline-block border rounded-full px-8 py-3 border-grayscale-600 hover:animate-wiggle hover:bg-main-500 hover:text-grayscale-200 hover:border-main-500"}," 더 불러오기 ")):r("",!0),!d(m)&&d(y)?(t(),a("span",Ce," End. ")):r("",!0)])])])):r("",!0),(S=d(h))!=null&&S.length?r("",!0):(t(),a("div",Ie,qe)),n("div",Ee,[o.col.creatable?(t(),L(f,{key:0,class:"link-item",to:{path:`/admin/${o.col.key}/write`,query:{no:Number(((V=d(g)[0])==null?void 0:V.no)+1||0)}}},{default:ee(()=>[F(" 새로 추가하기 ")]),_:1},8,["to"])):r("",!0)])])}}},Fe=U(Ne,[["__scopeId","data-v-2df78cbf"]]);export{Fe as default};
