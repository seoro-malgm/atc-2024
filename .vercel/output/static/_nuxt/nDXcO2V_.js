import{_ as H}from"./BpXSsMon.js";import{_ as J}from"./CdeBx9jp.js";import{_ as K,f as U,k as $,g as A,l as W,m as X,c as a,h as d,a as n,F as f,n as C,b as Y,q as r,i as L,w as Z,j as ee,o as t,t as I,s as O,d as F,p as te,e as ae}from"./is6tbSo-.js";import{u as se}from"./gdvGJBvj.js";import{u as oe}from"./CumRf8dT.js";const D=s=>(te("data-v-9f657001"),s=s(),ae(),s),le={key:0},ne={class:"table mb-8"},ce={class:"text-left"},re=D(()=>n("th",null,"관리",-1)),de={key:0},ue=["colspan"],ie=["width"],ye=["href"],he=["href"],_e={class:"py-2 border-b",width:"10%"},ke={class:"flex flex-col"},ve=["onClick"],pe=["onClick"],fe=["onClick"],ge={key:1},be=["colspan"],xe=D(()=>n("div",{class:"text-center"},[n("span",{class:"text-sm"},"표시할 데이터가 없습니다.")],-1)),we=[xe],me={class:"mt-3"},$e={class:"footer-util"},Ce={key:1,class:"text-grayscale-400"},Ie={key:1,class:"text-center pt-4 pb-8 border-b border-b-grayscale-300"},De=D(()=>n("span",{class:"text-sm text-grayscale-500"}," 데이터가 없습니다.",-1)),qe=[De],Ee={class:"floating-btn"},Ne={__name:"index",props:{col:{type:Object,default:null},addQuery:{type:Object,default:null}},async setup(s){let g,q;const E=U(),u=s,N=se(),x=$(null),i=A(()=>{var o;return{...(o=u.col)==null?void 0:o.defaultQuery,...u.addQuery,...E.query}}),y=$(!1),Q=async o=>{var _;y.value=!1;const c=await $fetch(`/api/collection/${u.col.key}`,{query:o});return(_=i==null?void 0:i.value)!=null&&_.limit&&(c==null?void 0:c.length)<i.value.limit&&(y.value=!0),c},{data:b,pending:w,error:Qe,refresh:z}=([g,q]=W(async()=>oe(`${u.col.key}-items-admin`,async()=>{var o;return await Q({...(o=u.col)==null?void 0:o.defaultQuery,...u.addQuery,...E.query})})),g=await g,q(),g),k=$([]),h=A(()=>[...b.value,...k.value]),M=async()=>{const o=h.value[h.value.length-1].id;x.value===o&&(y.value=!0),x.value=o;const c=await Q({...i.value,startAfter:o});c&&(k.value=[...k.value,...c])};X(()=>i.value,async(o,c)=>{k.value=[],x.value=null,y.value=!1,await z()});const P=async(o,c,_)=>{if(await window.confirm("삭제사히겠습니까?"))try{if(await $fetch(`/api/${o}/document`,{method:"DELETE",query:{id:c}})){N.add({id:`work-delete-${new Date().getTime()}`,title:"정상적으로 삭제했습니다.",icon:"memory:checkbox-marked"});const p=[...b.value,...k.value];p.splice(_,1),b.value=p}}catch(v){N.add({id:`${u.col.key}-delete-fail`,title:`ERROR ${v.statusCode}`,description:v.data.message||"문제가 발생하여 실패햇습니다.",icon:"memory:alert-octagon",color:"red"})}};return(o,c)=>{var p,B,R,S,V,j;const _=ee("status-loading"),T=H,v=J;return t(),a("div",null,[(p=d(h))!=null&&p.length?(t(),a("section",le,[n("table",ne,[n("thead",null,[n("tr",null,[(t(!0),a(f,null,C(s.col.list.key,(l,m)=>(t(),a("th",ce,I(l.text),1))),256)),re])]),n("tbody",null,[d(w)?(t(),a("tr",de,[n("td",{colspan:((B=s.col.list.key)==null?void 0:B.length)+1},[Y(_)],8,ue)])):r("",!0),(t(!0),a(f,null,C(d(h),(l,m)=>(t(),a("tr",{key:m},[(t(!0),a(f,null,C(s.col.list.key,(e,G)=>(t(),a("td",{key:G,width:e!=null&&e.width?`${e.width}%`:"auto"},[l[e.value]||l[e.value]!==""?(t(),a(f,{key:0},[e.type==="string"?(t(),a("p",{key:0,class:O(["truncate max-w-full px-3",e==null?void 0:e.addtionalClass])},I(l[e.value]),3)):e.type==="url"?(t(),a("a",{key:1,class:O(["link-item text-blue-400 underline mx-2 px-2",e==null?void 0:e.addtionalClass]),href:`https://seoro-malgm.studio/${e.url}/${l[e.value]}`,target:"_blank"},I(l[e.value]),11,ye)):e.type==="image"?(t(),L(T,{key:2,preset:"adminThumbnail",src:l[e.value]},null,8,["src"])):e.type==="file"?(t(),a("a",{key:3,href:l[e.value],target:"_blank",class:"link-item text-blue-400 underline mx-2 px-2"}," 미리보기 ",8,he)):(t(),a(f,{key:4},[F(" - ")],64))],64)):r("",!0)],8,ie))),128)),n("td",_e,[n("div",ke,[s.col.removeable?(t(),a("button",{key:0,onClick:e=>P(s.col.key,l==null?void 0:l.id,m),class:"bg-red-600 text-grayscale-200 rounded-md mb-1 py-1"}," 삭제 ",8,ve)):r("",!0),s.col.editable?(t(),a("button",{key:1,class:"bg-orange-500 text-grayscale-200 rounded-md py-1",onClick:e=>o.$router.push({path:`/admin/${s.col.key}/write`,query:{id:l==null?void 0:l.id}})}," 수정 ",8,pe)):r("",!0),s.col.preview?(t(),a("button",{key:2,class:"bg-orange-500 text-grayscale-200 rounded-md py-1",onClick:e=>o.$router.push({path:`/admin/${s.col.key}/${l.id}`})}," 상세보기 ",8,fe)):r("",!0)])])]))),128)),(R=d(h))!=null&&R.length?r("",!0):(t(),a("tr",ge,[n("td",{colspan:((S=s.col.list.key)==null?void 0:S.length)+1},we,8,be)]))])]),n("section",me,[n("nav",$e,[!d(w)&&!d(y)?(t(),a("button",{key:0,onClick:c[0]||(c[0]=l=>M()),class:"inline-block border border-grayscale-800 rounded-full px-8 py-3 border-grayscale-800 hover:animate-wiggle hover:bg-spring-green-500 hover:text-grayscale-200 hover:border-spring-green-500"}," 더 불러오기 ")):r("",!0),!d(w)&&d(y)?(t(),a("span",Ce," End. ")):r("",!0)])])])):r("",!0),(V=d(h))!=null&&V.length?r("",!0):(t(),a("div",Ie,qe)),n("div",Ee,[s.col.creatable?(t(),L(v,{key:0,class:"link-item",to:{path:`/admin/${s.col.key}/write`,query:{no:Number(((j=d(b)[0])==null?void 0:j.no)+1||0)}}},{default:Z(()=>[F(" 새로 추가하기 ")]),_:1},8,["to"])):r("",!0)])])}}},je=K(Ne,[["__scopeId","data-v-9f657001"]]);export{je as default};
