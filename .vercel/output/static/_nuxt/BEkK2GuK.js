import{_ as H}from"./S_NYMxyP.js";import{_ as J}from"./Bjz4UKv2.js";import{_ as K,f as U,k as $,g as A,l as W,m as X,c as o,h as d,a as l,F as g,n as C,b as Y,q as r,i as L,w as Z,j as ee,o as t,t as I,s as O,d as F,p as te,e as oe}from"./Bc1ekGIV.js";import{u as ae}from"./DO5H3ly-.js";import{u as se}from"./BWxgttte.js";const D=a=>(te("data-v-d0032392"),a=a(),oe(),a),ne={key:0},le={class:"table mb-8"},ce={class:"text-left"},re=D(()=>l("th",null,"관리",-1)),de={key:0},ue=["colspan"],ie=["width"],ye=["href"],he=["href"],_e={class:"py-2 border-b",width:"10%"},ke={class:"flex flex-col"},ve=["onClick"],pe=["onClick"],ge=["onClick"],fe={key:1},be=["colspan"],xe=D(()=>l("div",{class:"text-center"},[l("span",{class:"text-sm"},"표시할 데이터가 없습니다.")],-1)),we=[xe],me={class:"mt-3"},$e={class:"footer-util"},Ce={key:1,class:"text-gray-400"},Ie={key:1,class:"text-center pt-4 pb-8 border-b border-b-gray-300"},De=D(()=>l("span",{class:"text-sm text-gray-500"}," 데이터가 없습니다.",-1)),qe=[De],Ee={class:"floating-btn"},Ne={__name:"index",props:{col:{type:Object,default:null},addQuery:{type:Object,default:null}},async setup(a){let f,q;const E=U(),u=a,N=ae(),x=$(null),i=A(()=>{var s;return{...(s=u.col)==null?void 0:s.defaultQuery,...u.addQuery,...E.query}}),y=$(!1),Q=async s=>{var _;y.value=!1;const c=await $fetch(`/api/collection/${u.col.key}`,{query:s});return(_=i==null?void 0:i.value)!=null&&_.limit&&(c==null?void 0:c.length)<i.value.limit&&(y.value=!0),c},{data:b,pending:w,error:Qe,refresh:z}=([f,q]=W(async()=>se(`${u.col.key}-items-admin`,async()=>{var s;return await Q({...(s=u.col)==null?void 0:s.defaultQuery,...u.addQuery,...E.query})})),f=await f,q(),f),k=$([]),h=A(()=>[...b.value,...k.value]),M=async()=>{const s=h.value[h.value.length-1].id;x.value===s&&(y.value=!0),x.value=s;const c=await Q({...i.value,startAfter:s});c&&(k.value=[...k.value,...c])};X(()=>i.value,async(s,c)=>{k.value=[],x.value=null,y.value=!1,await z()});const P=async(s,c,_)=>{if(await window.confirm("삭제사히겠습니까?"))try{if(await $fetch(`/api/${s}/document`,{method:"DELETE",query:{id:c}})){N.add({id:`work-delete-${new Date().getTime()}`,title:"정상적으로 삭제했습니다.",icon:"memory:checkbox-marked"});const p=[...b.value,...k.value];p.splice(_,1),b.value=p}}catch(v){N.add({id:`${u.col.key}-delete-fail`,title:`ERROR ${v.statusCode}`,description:v.data.message||"문제가 발생하여 실패햇습니다.",icon:"memory:alert-octagon",color:"red"})}};return(s,c)=>{var p,B,R,S,V,j;const _=ee("status-loading"),T=H,v=J;return t(),o("div",null,[(p=d(h))!=null&&p.length?(t(),o("section",ne,[l("table",le,[l("thead",null,[l("tr",null,[(t(!0),o(g,null,C(a.col.list.key,(n,m)=>(t(),o("th",ce,I(n.text),1))),256)),re])]),l("tbody",null,[d(w)?(t(),o("tr",de,[l("td",{colspan:((B=a.col.list.key)==null?void 0:B.length)+1},[Y(_)],8,ue)])):r("",!0),(t(!0),o(g,null,C(d(h),(n,m)=>(t(),o("tr",{key:m},[(t(!0),o(g,null,C(a.col.list.key,(e,G)=>(t(),o("td",{key:G,width:e!=null&&e.width?`${e.width}%`:"auto"},[n[e.value]||n[e.value]!==""?(t(),o(g,{key:0},[e.type==="string"?(t(),o("p",{key:0,class:O(["truncate max-w-full px-3",e==null?void 0:e.addtionalClass])},I(n[e.value]),3)):e.type==="url"?(t(),o("a",{key:1,class:O(["link-item text-blue-400 underline mx-2 px-2",e==null?void 0:e.addtionalClass]),href:`https://seoro-malgm.studio/${e.url}/${n[e.value]}`,target:"_blank"},I(n[e.value]),11,ye)):e.type==="image"?(t(),L(T,{key:2,preset:"adminThumbnail",src:n[e.value]},null,8,["src"])):e.type==="file"?(t(),o("a",{key:3,href:n[e.value],target:"_blank",class:"link-item text-blue-400 underline mx-2 px-2"}," 미리보기 ",8,he)):(t(),o(g,{key:4},[F(" - ")],64))],64)):r("",!0)],8,ie))),128)),l("td",_e,[l("div",ke,[a.col.removeable?(t(),o("button",{key:0,onClick:e=>P(a.col.key,n==null?void 0:n.id,m),class:"bg-red-600 text-gray-200 rounded-md mb-1 py-1"}," 삭제 ",8,ve)):r("",!0),a.col.editable?(t(),o("button",{key:1,class:"bg-orange-500 text-gray-200 rounded-md py-1",onClick:e=>s.$router.push({path:`/admin/${a.col.key}/write`,query:{id:n==null?void 0:n.id}})}," 수정 ",8,pe)):r("",!0),a.col.preview?(t(),o("button",{key:2,class:"bg-orange-500 text-gray-200 rounded-md py-1",onClick:e=>s.$router.push({path:`/admin/${a.col.key}/${n.id}`})}," 상세보기 ",8,ge)):r("",!0)])])]))),128)),(R=d(h))!=null&&R.length?r("",!0):(t(),o("tr",fe,[l("td",{colspan:((S=a.col.list.key)==null?void 0:S.length)+1},we,8,be)]))])]),l("section",me,[l("nav",$e,[!d(w)&&!d(y)?(t(),o("button",{key:0,onClick:c[0]||(c[0]=n=>M()),class:"inline-block border rounded-full px-8 py-3 border-gray-600 hover:animate-wiggle hover:bg-spring-green-500 hover:text-gray-200 hover:border-spring-green-500"}," 더 불러오기 ")):r("",!0),!d(w)&&d(y)?(t(),o("span",Ce," End. ")):r("",!0)])])])):r("",!0),(V=d(h))!=null&&V.length?r("",!0):(t(),o("div",Ie,qe)),l("div",Ee,[a.col.creatable?(t(),L(v,{key:0,class:"link-item",to:{path:`/admin/${a.col.key}/write`,query:{no:Number(((j=d(b)[0])==null?void 0:j.no)+1||0)}}},{default:Z(()=>[F(" 새로 추가하기 ")]),_:1},8,["to"])):r("",!0)])])}}},je=K(Ne,[["__scopeId","data-v-d0032392"]]);export{je as default};
