import{s as M,v as z,j as $,g as k,x as E,y as H,z as V,_ as U,l as C,A as S,o as f,c as y,a as _,t as q,n as P,B as F,b as w,F as G,i as L,f as O,C as X,w as J,r as K}from"./D2dFwJ2f.js";import{_ as Q}from"./DykwY3kg.js";import{u as A}from"./CjDdrw6I.js";import W from"./Bvd1MlKc.js";import{_ as Y}from"./BuYN90_f.js";import{_ as Z}from"./DuvxkUR_.js";import"./DZS6RxCO.js";import"./qsMMcMsd.js";function tt(t,e){const o=e/t*100;return 2/Math.PI*100*Math.atan(o/50)}function et(t={}){const{duration:e=2e3,throttle:o=200,hideDelay:m=500,resetDelay:i=400}=t,c=t.estimatedProgress||tt,l=E(),a=$(0),d=$(!1);let p=!1,r,u,s,n;const h=()=>v(0);function v(g=0){if(!l.isHydrating){if(g>=100)return x();I(),a.value=g<0?0:g,o?u=setTimeout(()=>{d.value=!0,N()},o):(d.value=!0,N())}}function b(){s=setTimeout(()=>{d.value=!1,n=setTimeout(()=>{a.value=0},i)},m)}function x(g={}){a.value=100,p=!0,I(),j(),g.force?(a.value=0,d.value=!1):b()}function j(){clearTimeout(s),clearTimeout(n)}function I(){clearTimeout(u),cancelAnimationFrame(r)}function N(){p=!1;let g;function T(D){if(p)return;g??(g=D);const B=D-g;a.value=Math.max(0,Math.min(100,c(e,B))),r=requestAnimationFrame(T)}r=requestAnimationFrame(T)}let R=()=>{};{const g=l.hook("page:loading:start",()=>{h()}),T=l.hook("page:loading:end",()=>{x()}),D=l.hook("vue:error",()=>x());R=()=>{D(),g(),T(),I()}}return{_cleanup:R,progress:k(()=>a.value),isLoading:k(()=>d.value),start:h,set:v,finish:x,clear:I}}function ot(t={}){const e=E(),o=e._loadingIndicator=e._loadingIndicator||et(t);return M()&&(e._loadingIndicatorDeps=e._loadingIndicatorDeps||0,e._loadingIndicatorDeps++,z(()=>{e._loadingIndicatorDeps--,e._loadingIndicatorDeps===0&&(o._cleanup(),delete e._loadingIndicator)})),o}const nt=H({name:"NuxtLoadingIndicator",props:{throttle:{type:Number,default:200},duration:{type:Number,default:2e3},height:{type:Number,default:3},color:{type:[String,Boolean],default:"repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%)"},estimatedProgress:{type:Function,required:!1}},setup(t,{slots:e,expose:o}){const{progress:m,isLoading:i,start:c,finish:l,clear:a}=ot({duration:t.duration,throttle:t.throttle,estimatedProgress:t.estimatedProgress});return o({progress:m,isLoading:i,start:c,finish:l,clear:a}),()=>V("div",{class:"nuxt-loading-indicator",style:{position:"fixed",top:0,right:0,left:0,pointerEvents:"none",width:"auto",height:`${t.height}px`,opacity:i.value?1:0,background:t.color||void 0,backgroundSize:`${100/m.value*100}% auto`,transform:`scaleX(${m.value}%)`,transformOrigin:"left",transition:"transform 0.1s, height 0.4s, opacity 0.4s",zIndex:999999}},e)}}),at={class:"input-group"},it={class:"input"},rt={key:0,class:"input-title"},st={key:1,class:"input-desc"},lt={key:2,class:"attached-image"},ut=["src"],ct={class:"utils"},dt={key:1,class:"input-file"},mt=["required","autocomplete","id"],pt=["for"],ft={__name:"image",props:{id:{type:String,default:"input-file-obj"},title:{type:String,default:null},desc:{type:String,default:null},inputType:{type:String,default:null},form:{type:Object,required:!0,default:null},bind:{type:String,required:!0,default:null},path:{type:String,required:!0,default:"image"},required:{type:Boolean,default:null},autocomplete:{type:String,default:null}},emits:{input:t=>!0},setup(t,{emit:e}){const o=t,m=e,i=$(null),c=$(null);C(()=>i.value,(r,u)=>{m("input",r)}),C(()=>o.form[o.bind],(r,u)=>{i.value=r,m("input",r)}),S(()=>{o.form[o.bind]&&(i.value=o.form[o.bind])});const l=A(),a=$(!1),d=async r=>{const u=r.target.files[0];if(u){a.value=!0;try{const s=u==null?void 0:u.type.split("/").at(-1),n=`${o.path}_${new Date().getTime()}.${s}`,h=new FormData;h.append("file",u);const v=await $fetch("/api/storage/create",{method:"POST",body:h,query:{path:o.path,fileName:n,type:u.type}});v&&(i.value=v.url,c.value=v.name)}catch(s){l.add({id:"upload-fail",title:`ERROR ${s.statusCode}`,description:s.data.message||"에러가 발생하였습니다.",icon:"memory:alert-octagon",color:"red"})}finally{a.value=!1,r.target.value=""}}},p=async r=>{r!=null&&r.name&&await $fetch("/api/storage/delete",{method:"DELETE",query:{path:o.path,fileName:r.name}}),a.value=!1,i.value=null,c.value=null};return(r,u)=>{const s=W,n=Y;return f(),y("div",at,[_("div",it,[t.title?(f(),y("span",rt,q(t.title),1)):P("",!0),t.desc?(f(),y("p",st,q(t.desc),1)):P("",!0),i.value?(f(),y("figure",lt,[_("img",{src:i.value,alt:"현재 업로드된 이미지"},null,8,ut),_("div",ct,[_("button",{onClick:u[0]||(u[0]=F(h=>p(c.value),["prevent"])),class:"btn-remove"},[w(s,{name:"memory:trash"})])])])):(f(),y(G,{key:3},[a.value?(f(),L(n,{key:0})):(f(),y("div",dt,[_("input",{type:"file",onChange:d,required:t.required,autocomplete:t.autocomplete,id:t.id,accept:".png, .jpg, .jpeg"},null,40,mt),_("label",{for:t.id,class:"input-label"}," 이미지 업로드 ",8,pt)]))],64))])])}}},gt=U(ft,[["__scopeId","data-v-67670b5e"]]),_t={id:"form-sponsor"},yt={class:"mb-4 w-full md:w-3/12 lg:w-2/12"},ht={class:"mb-4"},vt={__name:"sponsors",props:{col:{type:Object,default:null},id:{type:String,default:null},form:{type:Object,default:null}},setup(t,{emit:e}){const o=e;$(!1);const m=O(),i=k(()=>{var c;return(c=m.query)==null?void 0:c.no});return S(()=>{o("input",["no",i.value?i.value:0])}),(c,l)=>{const a=gt,d=Z;return f(),y("div",_t,[_("div",yt,[w(a,{form:t.form,bind:"logo",path:"sponsors",title:"로고",onInput:l[0]||(l[0]=p=>c.$emit("input",["logo",p]))},null,8,["form"])]),_("div",ht,[w(d,{class:"mb-6",form:t.form,bind:"name",title:"이름",onInput:l[1]||(l[1]=p=>c.$emit("input",["name",p]))},null,8,["form"])])])}}},bt={key:0,class:"pt-4 border-t"},$t=_("h6",{class:"text-2xl mb-3"},"form 데이터 미리보기 :",-1),kt={class:"block w-full overflow-auto bg-grayscale-300 border border-grayscale-800 text-wrap p-6 rounded-xl"},Nt={__name:"write",props:{col:{type:Object,default:null}},setup(t){const e=t,o=O(),m=X(),i=A(),c={sponsors:vt},l=k(()=>c[e.col.key]);S(()=>{(!e.col.key||!l.value)&&(window.alert("잘못된 접근입니다."),m.go(-1))});const a=$({}),d=k(()=>{var s;return(s=o==null?void 0:o.query)==null?void 0:s.id});S(()=>{d.value&&p(d.value)});const p=async s=>{const n=await $fetch(`/api/${e.col.key}/document`,{method:"GET",params:{col:e.col.key},query:{id:s}});n&&(a.value={...n})},r=async s=>{try{await $fetch(`/api/${e.col.key}/document`,{method:"POST",body:{...a.value,createdAt:new Date().toLocaleString()}})&&(m.push(`/admin/${e.col.key}`),i.add({id:`work-added-${new Date().getTime()}`,title:"정상적으로 추가되었습니다..",icon:"memory:checkbox-marked"}))}catch(n){i.add({id:`${e.col.key}-write-fail`,title:`ERROR ${n.statusCode}`,description:n.data.message||"업로드중에 문제가 발생하여 실패햇습니다.",icon:"memory:alert-octagon",color:"red"})}},u=async s=>{try{await $fetch(`/api/${e.col.key}/document`,{method:"PUT",body:{...a.value},query:{id:d.value}})&&(m.push(`/admin/${e.col.key}`),i.add({id:`work-added-${new Date().getTime()}`,title:"정상적으로 수정되었습니다",icon:"memory:checkbox-marked"}))}catch(n){i.add({id:`${e.col.key}-update-fail`,title:`ERROR ${n.statusCode}`,description:n.data.message||"업데이트중에 문제가 발생하여 실패햇습니다.",icon:"memory:alert-octagon",color:"red"})}};return(s,n)=>{const h=nt,v=Q;return f(),y("div",null,[w(h),w(v,{onSubmit:n[2]||(n[2]=F(b=>d.value?u():r(),["prevent"]))},{default:J(()=>[(f(),L(K(l.value),{col:t.col,id:d.value,form:a.value,onInput:n[0]||(n[0]=b=>a.value[b[0]]=b[1]),onInit:n[1]||(n[1]=b=>a.value=b)},null,40,["col","id","form"])),t.col.formPreview?(f(),y("div",bt,[$t,_("pre",kt,"form: "+q(a.value)+`
      `,1)])):P("",!0)]),_:1})])}}};export{Nt as default};
